<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exploring SWATplusR • SWATplusR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Exploring SWATplusR">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SWATplusR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.3.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/SWATplusR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/SWATplusR1.html">Bla</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chrisschuerz/SWATplusR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Exploring SWATplusR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/chrisschuerz/SWATplusR/blob/master/vignettes/SWATplusR.Rmd"><code>vignettes/SWATplusR.Rmd</code></a></small>
      <div class="hidden name"><code>SWATplusR.Rmd</code></div>

    </div>

    
    
<div id="loading-r-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-r-packages" class="anchor"></a>Loading R packages</h2>
<p>Before exploring the package load <code>SWATplusR</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(SWATplusR)</code></pre></div>
</div>
<div id="loading-demos" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-demos" class="anchor"></a>Loading demos</h2>
<div id="swat-projects" class="section level3">
<h3 class="hasAnchor">
<a href="#swat-projects" class="anchor"></a>SWAT projects</h3>
<p><code>SWATplusR</code> provides very simple model setups of a head watershed of the Little River Experimental Watershed <span class="citation">(LREW; Bosch et al., <a href="#ref-Bosch2007">2007</a>)</span>. Demo model setups can be retrieved for SWAT2012 and for SWAT+. Currently a SWAT2012 demo is available for Windows and Linux, while for SWAT+ only a setup for Windows is currently available. A demo project can be loaded with the following command.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The path where the SWAT demo project will be written</span>
demo_path &lt;-<span class="st"> "Define:/your/path"</span>

<span class="co"># Loading a SWAT+ demo project</span>
path_plus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_demo.html">load_demo</a></span>(<span class="dt">dataset =</span> <span class="st">"project"</span>,
                       <span class="dt">swat_version =</span> <span class="st">"plus"</span>,
                       <span class="dt">path =</span> demo_path)

<span class="co"># Loading a SWAT2012 demo project</span>
path_<span class="dv">2012</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_demo.html">load_demo</a></span>(<span class="dt">dataset =</span> <span class="st">"project"</span>,
                       <span class="dt">swat_version =</span> <span class="st">"2012"</span>,
                       <span class="dt">path =</span> demo_path)</code></pre></div>
<p>Here <code><a href="../reference/load_demo.html">load_demo()</a></code> loads a demo project data set and saves it in the defined <code>demo_path</code>. Additionally, the function returns the final demo project path (<code>path_plus</code> and <code>path_2012</code>) as a character string back to R. This path is directly usable to run the SWAT model in that path.</p>
</div>
<div id="observation-data" class="section level3">
<h3 class="hasAnchor">
<a href="#observation-data" class="anchor"></a>Observation data</h3>
<p><code>SWATplusR</code> also provides observation data of daily discharge records at the main outlet of the demo for the time period 1968-01-01 until 2012-12-31. The data set is useful for the model evaluation of a demo project. You can load the observation data as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_obs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_demo.html">load_demo</a></span>(<span class="dt">dataset =</span> <span class="st">"observation"</span>)

q_obs
<span class="co">#&gt; # A tibble: 16,437 x 2</span>
<span class="co">#&gt;    date       q_out</span>
<span class="co">#&gt;    &lt;date&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt;  1 1968-01-01 0.16 </span>
<span class="co">#&gt;  2 1968-01-02 0.570</span>
<span class="co">#&gt;  3 1968-01-03 0.61 </span>
<span class="co">#&gt;  4 1968-01-04 0.37 </span>
<span class="co">#&gt;  5 1968-01-05 0.25 </span>
<span class="co">#&gt;  6 1968-01-06 0.2  </span>
<span class="co">#&gt;  7 1968-01-07 0.21 </span>
<span class="co">#&gt;  8 1968-01-08 0.22 </span>
<span class="co">#&gt;  9 1968-01-09 0.18 </span>
<span class="co">#&gt; 10 1968-01-10 0.34 </span>
<span class="co">#&gt; # ... with 16,427 more rows</span></code></pre></div>
<p>A quick plot of the observation data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(q_obs, <span class="dt">type =</span> <span class="st">"l"</span>)</code></pre></div>
<p><img src="SWATplusR_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="spatial-data" class="section level3">
<h3 class="hasAnchor">
<a href="#spatial-data" class="anchor"></a>Spatial data</h3>
<p>To visualize simulation results spatially, shape files of the subbasins, river network, and HRUs for the SWAT+ and the SWAT2012 demo setups are available from <code>SWATplusR</code>. For spatial data <code><a href="../reference/load_demo.html">load_demo()</a></code> only returns the paths to the shape files. As the spatial data for the two SWAT project setups looks different loading the data requires the definition of the <code>swat_version</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Path to the subbasin shape file</span>
sub_path &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_demo.html">load_demo</a></span>(<span class="dt">dataset =</span> <span class="st">"subbasin"</span>, <span class="dt">swat_version =</span> <span class="st">"plus"</span>)
<span class="co"># Path to the subbasin shape file</span>
riv_path &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_demo.html">load_demo</a></span>(<span class="dt">dataset =</span> <span class="st">"river"</span>, <span class="dt">swat_version =</span> <span class="st">"plus"</span>)

sub_path
<span class="co">#&gt; [1] "C:/Program Files/R/R-3.5.2/library/SWATplusR/extdata/plus_shapes/sub.shp"</span></code></pre></div>
<p>These paths you can use to load the spatial data with your preferred method. The package <code>sf</code> <span class="citation">(Pebesma, <a href="#ref-Pebesma2018a">2018</a>; Pebesma et al., <a href="#ref-Pebesma2018b">2018</a>)</span> provides a very elegant way to work with spatial vector objects in R that have a direct intergration for plotting in <code>ggplot2</code> <span class="citation">(Wickham, <a href="#ref-Wickham2016">2016</a>)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Loading the sf and ggplot2 packages for the visualization</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sf)
<span class="co">#&gt; Warning: package 'sf' was built under R version 3.5.3</span>
<span class="co">#&gt; Linking to GEOS 3.6.1, GDAL 2.2.3, PROJ 4.9.3</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

<span class="co"># Loading the spatial data as simple features</span>
sub &lt;-<span class="st"> </span><span class="kw">read_sf</span>(sub_path)
riv &lt;-<span class="st"> </span><span class="kw">read_sf</span>(riv_path)

<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> sub) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> riv, <span class="dt">col =</span> <span class="st">"royalblue"</span>, <span class="dt">lwd =</span> <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_sf_label</span>(<span class="dt">data =</span> riv, <span class="kw">aes</span>(<span class="dt">label =</span> Channel)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="SWATplusR_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
</div>
<div id="first-swat-model-runs" class="section level2">
<h2 class="hasAnchor">
<a href="#first-swat-model-runs" class="anchor"></a>First SWAT model runs</h2>
<p>SWAT projects (e.g. one of the demo projects) can be executed from R with the functions <code><a href="../reference/run_swat2012.html">run_swat2012()</a></code> to run a SWAT2012 project or <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> to run a SWAT+ project. The minimum requirements to execute a SWAT project are to provide the <code>project_path</code> to the project folder on the hard drive and to define the simulation outputs that the simulation should return to R. The definition of the simulation output always follows a simple pattern. An output variable that should be returned must be defined using the function <code><a href="../reference/define_output.html">define_output()</a></code>. Below is a simple example to run a SWAT+ project and return the <code>variable = 'flo_out'</code> that is written into the <code>file = 'channel'</code> file for the spatial <code>unit = 1</code>. <strong>Caution</strong> in the demo SWAT+ model setup the main channel is channel number 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_swatplus.html">run_swatplus</a></span>(<span class="dt">project_path =</span> plus_path,
                      <span class="dt">output =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"channel"</span>,
                                             <span class="dt">variable =</span> <span class="st">"flo_out"</span>,
                                             <span class="dt">unit =</span> <span class="dv">1</span>))

<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swatplus_demo/.model_run': </span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 0S   Time remaining: 0S    </span>
<span class="co">#&gt;  Completed 1 thread in 0S </span>
<span class="co">#&gt; Performing 1 simulation on 1 core: </span>
<span class="co">#&gt;  Simulation 1 of 1   Time elapsed: 3S   Time remaining: 0S</span>
<span class="co">#&gt;  Completed 1 simulation in 3S</span></code></pre></div>
<p>The syntax definition of simulations outputs applies to SWAT+ and SWAT2012. The only difference between the two models in the outdefinition is how to correctly address the output variables. The output files are differenty organized in the two SWAT versions. Below you find an example to extract the simulation outputs of discharge at all three subbasin outlets in the SWAT2012 demo setup:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_swat2012.html">run_swat2012</a></span>(<span class="dt">project_path =</span> path_<span class="dv">2012</span>,
                      <span class="dt">output =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"RCH"</span>,
                                             <span class="dt">variable =</span> <span class="st">"FLOW_OUT"</span>,
                                             <span class="dt">unit =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))

<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swat2012_demo/.model_run': </span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 3S   Time remaining: 0S    </span>
<span class="co">#&gt;  Completed 1 thread in 3S </span>
<span class="co">#&gt; Performing 1 simulation on 1 core: </span>
<span class="co">#&gt;  Simulation 1 of 1   Time elapsed: 4S   Time remaining: 0S</span>
<span class="co">#&gt;  Completed 1 simulation in 4S</span></code></pre></div>
<p>The discharge in SWAT2012 is written in to the file <em>“output.rch”</em>. The discharge leaving a subbasin is written in the column <em>“FLOW_OUT”</em>. The only additional difference in running a basic simuation with SWAT+ and SWAT2012 is the different function call (<code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> or <code><a href="../reference/run_swat2012.html">run_swat2012()</a></code>).</p>
<p>You might have noticed, that running SWAT also provides information on the progress. This is very convenient for long simulation runs with many model evaluations. If you implement the SWAT function into other function calls the writing to the console can be an undesired behavior. You can quiet the function call with the argument <code>quiet = TRUE</code>.</p>
<div id="output-definition" class="section level3">
<h3 class="hasAnchor">
<a href="#output-definition" class="anchor"></a>Output definition</h3>
<p>The previous examples illustrated how to extract one `<code>variable</code> (but maybe for several <code>units</code>) from the simulation outputs. To extract several variables you can simply combine them in a <code><a href="https://www.rdocumentation.org/packages/base/topics/list">list()</a></code>. In the example below we extract several water balance components of the SWAT+ demo simulations. Aggregated variables for a SWAT+ simulation are written to the <em>‘basin_wb’</em> file and there is only one spatial unit (the entire basin) written to that file. Therefore, the <code>unit</code> must be 1. Values different from 1 will not return any simulation results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wb_out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_swatplus.html">run_swatplus</a></span>(<span class="dt">project_path =</span> path_plus,
           <span class="dt">output =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">precip =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"basin_wb"</span>,
                                                <span class="dt">variable =</span> <span class="st">"precip"</span>,
                                                <span class="dt">unit =</span> <span class="dv">1</span>),
                         <span class="dt">q_sur  =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"basin_wb"</span>,
                                                <span class="dt">variable =</span> <span class="st">"surq_gen"</span>,
                                                <span class="dt">unit =</span> <span class="dv">1</span>),
                         <span class="dt">q_lat  =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"basin_wb"</span>,
                                                <span class="dt">variable =</span> <span class="st">"latq"</span>,
                                                <span class="dt">unit =</span> <span class="dv">1</span>),
                         <span class="dt">eta    =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"basin_wb"</span>,
                                                <span class="dt">variable =</span> <span class="st">"et"</span>,
                                                <span class="dt">unit =</span> <span class="dv">1</span>)))

<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swatplus_demo/.model_run': </span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 1S   Time remaining: 0S    </span>
<span class="co">#&gt;  Completed 1 thread in 1S </span>
<span class="co">#&gt; Performing 1 simulation on 1 core: </span>
<span class="co">#&gt;  Simulation 1 of 1   Time elapsed: 2S   Time remaining: 0S</span>
<span class="co">#&gt;  Completed 1 simulation in 2S</span></code></pre></div>
<p>The output definition in a list has the additional advantage to optionally assign individual names to the variables (e.g. <code><a href="https://www.rdocumentation.org/packages/base/topics/list">list(name_a = define_output(...))</a></code>). The variables are returned in the output with that name in R then.</p>
</div>
<div id="exploring-a-simulation" class="section level3">
<h3 class="hasAnchor">
<a href="#exploring-a-simulation" class="anchor"></a>Exploring a simulation</h3>
<p>The goal of <code>SWATplusR</code> is to return the SWAT simulations in a <em>tidy</em> format. The simulation results look slightly different if only one simulation was performed, parameters were modified in a run, or multiple parameter sets were used to perform a large number of model evaluations. In general the outputs follow a general structure.</p>
<p>If only one simulation was performed, where no model parameters were modified, <code>run_swat*()</code> returns a <code>tibble</code> with a <code>date</code> column and additional columns with the simulated values of the extracted variables on these dates. For the simulated water balance components the returned table looks as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wb_out
<span class="co">#&gt; # A tibble: 3,653 x 5</span>
<span class="co">#&gt;    date       precip q_sur q_lat   eta</span>
<span class="co">#&gt;    &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2003-01-01  4.28  0.144 2.28  0.425</span>
<span class="co">#&gt;  2 2003-01-02  0.387 0.021 1.68  0.951</span>
<span class="co">#&gt;  3 2003-01-03  0     0.005 1.34  0.081</span>
<span class="co">#&gt;  4 2003-01-04  0     0.001 1.15  0.742</span>
<span class="co">#&gt;  5 2003-01-05  0     0     1.03  0.7  </span>
<span class="co">#&gt;  6 2003-01-06  0     0     0.962 0.676</span>
<span class="co">#&gt;  7 2003-01-07  0     0     0.912 0.574</span>
<span class="co">#&gt;  8 2003-01-08  0     0     0.874 0.628</span>
<span class="co">#&gt;  9 2003-01-09  0     0     0.844 0.716</span>
<span class="co">#&gt; 10 2003-01-10  0     0     0.817 0.423</span>
<span class="co">#&gt; # ... with 3,643 more rows</span></code></pre></div>
<p>The <em>tidy</em> writing of the simulation results allows an easy processing of the data in the analysis workflow in R. Here is a quick example how to ‘wrangle’ the data with <code>dplyr</code> <span class="citation">(Wickham et al., <a href="#ref-Wickham2019">2019</a>)</span>, <code>lubridate</code> <span class="citation">(Grolemund and Wickham, <a href="#ref-Grolemund2011">2011</a>)</span> and <code>tidyr</code> <span class="citation">(Wickham and Henry, <a href="#ref-Wickham2018a">2018</a>)</span> and then plotting the water balance components with <code>ggplot2</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)
<span class="co">#&gt; Warning: package 'tidyr' was built under R version 3.5.3</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(lubridate)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)


wb_plot &lt;-<span class="st"> </span>wb_out <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year   =</span> <span class="kw">year</span>(date),
         <span class="dt">month  =</span> <span class="kw">month</span>(date)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="st"> </span>date) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(year, month) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(.))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>year) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(.))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(., <span class="dt">key =</span> <span class="st">"variable"</span>, <span class="dt">value =</span> <span class="st">"value"</span>, <span class="op">-</span><span class="st"> </span>month)
<span class="co">#&gt; Warning: funs() is soft deprecated as of dplyr 0.8.0</span>
<span class="co">#&gt; please use list() instead</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # Before:</span>
<span class="co">#&gt; funs(name = f(.)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # After: </span>
<span class="co">#&gt; list(name = ~f(.))</span>
<span class="co">#&gt; This warning is displayed once per session.</span>
  
<span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="co"># geom_col(data = filter(wb_plot, variable == "precip"),</span>
<span class="st">  </span><span class="co">#          aes(x = month, y = value, fill = variable)) + </span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(wb_plot, variable <span class="op">!=</span><span class="st"> "precip"</span>), 
           <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> value, <span class="dt">fill =</span> variable), 
           <span class="dt">alpha =</span> <span class="fl">0.9</span>, <span class="dt">position =</span> <span class="st">"stack"</span>)</code></pre></div>
<p><img src="SWATplusR_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Bosch2007">
<p>Bosch, D. D., Sheridan, J. M., Lowrance, R. R., Hubbard, R. K., Strickland, T. C., Feyereisen, G. W. and Sullivan, D. G.: Little river experimental watershed database, Water Resources Research, 43(9), doi:<a href="https://doi.org/10.1029/2006wr005844">10.1029/2006wr005844</a>, 2007.</p>
</div>
<div id="ref-Grolemund2011">
<p>Grolemund, G. and Wickham, H.: Dates and times made easy withlubridate, Journal of Statistical Software, 40(3), doi:<a href="https://doi.org/10.18637/jss.v040.i03">10.18637/jss.v040.i03</a>, 2011.</p>
</div>
<div id="ref-Pebesma2018a">
<p>Pebesma, E.: Simple Features for R: Standardized Support for Spatial Vector Data, The R Journal, 10(1), 439–446, doi:<a href="https://doi.org/10.32614/RJ-2018-009">10.32614/RJ-2018-009</a>, 2018.</p>
</div>
<div id="ref-Pebesma2018b">
<p>Pebesma, E., Bivand, R., Racine, E., Sumner, M., Cook, I., Keitt, T., Lovelace, R., Wickham, H., Ooms, J., Müller, K. and Pedersen, T. L.: sf: Simple Features for R. [online] Available from: <a href="https://CRAN.R-project.org/package=sf" class="uri">https://CRAN.R-project.org/package=sf</a> (Accessed 5 March 2019), 2018.</p>
</div>
<div id="ref-Wickham2016">
<p>Wickham, H.: ggplot2: Elegant Graphics for Data Analysis, Springer-Verlag New York. [online] Available from: <a href="http://ggplot2.org" class="uri">http://ggplot2.org</a>, 2016.</p>
</div>
<div id="ref-Wickham2018a">
<p>Wickham, H. and Henry, L.: Tidyr: Easily tidy data with ’spread()’ and ’gather()’ functions. [online] Available from: <a href="https://CRAN.R-project.org/package=tidyr" class="uri">https://CRAN.R-project.org/package=tidyr</a> (Accessed 3 May 2019), 2018.</p>
</div>
<div id="ref-Wickham2019">
<p>Wickham, H., François, R., Henry, L. and Müller, K.: Dplyr: A grammar of data manipulation. [online] Available from: <a href="https://CRAN.R-project.org/package=dplyr" class="uri">https://CRAN.R-project.org/package=dplyr</a> (Accessed 5 March 2019), 2019.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#loading-r-packages">Loading R packages</a></li>
      <li><a href="#loading-demos">Loading demos</a></li>
      <li><a href="#first-swat-model-runs">First SWAT model runs</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christoph Schuerz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
